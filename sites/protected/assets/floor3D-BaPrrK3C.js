import{s as v,b as R,c as V}from"./index-DjK5nMnr.js";const W=150,D=50,B=4;function O(S,y,u,e,s,F){const E="http://www.w3.org/2000/svg",p=S.slice(0,S.length-1),r=S.map(t=>`${t[0]+D},${t[1]+W}`).join(" "),a=document.createElementNS(E,"polygon");a.setAttribute("points",r),a.setAttribute("fill",F),a.setAttribute("stroke",u),a.setAttribute("stroke-width",String(B)),y.appendChild(a);const g=[];for(let t=0;t<p.length;t++){const o=p[t],C=p[(t+1)%p.length],k=[o[0]+D,o[1]+W],b=[C[0]+D,C[1]+W],f=[o,C,b,k].map(P=>P.join(",")).join(" "),I=(o[1]+C[1])/2<3e3;g.push({wallPoints:f,isBackWall:I})}g.sort((t,o)=>t.isBackWall===o.isBackWall?0:t.isBackWall?-1:1),g.forEach(({wallPoints:t})=>{const o=document.createElementNS(E,"polygon");o.setAttribute("points",t),o.setAttribute("fill",s),o.setAttribute("stroke",u),o.setAttribute("stroke-width",String(B)),y.appendChild(o)});const n=S.map(t=>t.join(",")).join(" "),d=document.createElementNS(E,"polygon");d.setAttribute("points",n),d.setAttribute("fill",e),d.setAttribute("stroke",u),d.setAttribute("stroke-width",String(B)),y.appendChild(d)}function X(S,y){const u=document.getElementById(y);if(!u){console.error(`Container mit der ID "${y}" nicht gefunden.`);return}u.innerHTML="";const e="http://www.w3.org/2000/svg",s=document.createElementNS(e,"svg");s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("viewBox","-500 -500 4000 4000");const F=getComputedStyle(document.body).getPropertyValue("--color-surface").trim()||"#ffffff",E=getComputedStyle(document.body).getPropertyValue("--color-secondary").trim()||"#f6ebfc",p=document.createElementNS(e,"defs"),r=document.createElementNS(e,"linearGradient");r.id="bgGrad",r.setAttribute("x1","0"),r.setAttribute("y1","0"),r.setAttribute("x2","0"),r.setAttribute("y2","1");const a=document.createElementNS(e,"stop");a.setAttribute("offset","0%"),a.setAttribute("stop-color",E);const g=document.createElementNS(e,"stop");g.setAttribute("offset","100%"),g.setAttribute("stop-color",F),r.appendChild(a),r.appendChild(g);const n=document.createElementNS(e,"filter");n.id="softShadow",n.setAttribute("x","-20%"),n.setAttribute("y","-20%"),n.setAttribute("width","140%"),n.setAttribute("height","140%");const d=document.createElementNS(e,"feGaussianBlur");d.setAttribute("in","SourceAlpha"),d.setAttribute("stdDeviation","6");const t=document.createElementNS(e,"feOffset");t.setAttribute("dx","6"),t.setAttribute("dy","6"),t.setAttribute("result","offsetblur");const o=document.createElementNS(e,"feMerge"),C=document.createElementNS(e,"feMergeNode"),k=document.createElementNS(e,"feMergeNode");k.setAttribute("in","SourceGraphic"),o.appendChild(C),o.appendChild(k),n.appendChild(d),n.appendChild(t),n.appendChild(o),p.appendChild(r),p.appendChild(n),s.appendChild(p);const b=document.createElementNS(e,"rect");b.setAttribute("x","-500"),b.setAttribute("y","-500"),b.setAttribute("width","4000"),b.setAttribute("height","4000"),b.setAttribute("fill","url(#bgGrad)"),s.appendChild(b);const f=document.createElementNS(e,"g");f.id="interactive-3d-group",f.setAttribute("transform",`translate(${v.threeDPan.x}, ${v.threeDPan.y}) scale(${v.threeDScale})`),f.setAttribute("filter","url(#softShadow)"),s.appendChild(f);const I=R(),P=S.features.filter(i=>i.properties.floor===v.activeFloorId&&i.geometry.type==="Polygon"&&!i.properties.isPlaceholder);if(P.length===0){u.appendChild(s);return}const w=document.createElementNS(e,"g");w.setAttribute("transform","translate(0, 0)");function G(i,h){const l=i.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*([\d.]+))?\)/);if(l){const N=parseInt(l[1],10),x=parseInt(l[2],10),$=parseInt(l[3],10);return`rgba(${N}, ${x}, ${$}, ${h})`}const m=i.trim();if(/^#([\da-f]{6})$/i.test(m)){const N=parseInt(m.slice(1,3),16),x=parseInt(m.slice(3,5),16),$=parseInt(m.slice(5,7),16);return`rgba(${N}, ${x}, ${$}, ${h})`}return`rgba(0,0,0,${h})`}P.forEach(i=>{const h=i.geometry,l=I[i.properties.subType]||I.default,m=l.stroke||"#54176e",N=l.fill?G(l.fill,.45):"rgba(53,138,216,0.35)",x=G(m,.25),$=G(m,.12);O(h.coordinates[0],w,m,N,x,$);const T=document.createElementNS(e,"polygon"),_=h.coordinates[0].map(A=>`${A[0]+D+15},${A[1]+W+15}`).join(" ");T.setAttribute("points",_),T.setAttribute("fill","rgba(0,0,0,0.06)"),T.setAttribute("stroke","none"),w.appendChild(T);const H=i.properties.label;if(H){const A=V(h),j=A.x+A.width/2,L=A.y+A.height/2,c=document.createElementNS(e,"text");c.setAttribute("x",String(j)),c.setAttribute("y",String(L)),c.setAttribute("text-anchor","middle"),c.setAttribute("dominant-baseline","middle");const M=getComputedStyle(document.body).getPropertyValue("--color-text").trim()||"#333333";c.setAttribute("fill",M),c.setAttribute("stroke",v.activeTheme==="dark"?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.7)"),c.setAttribute("stroke-width","1.5");const z=l.fontSize?Math.max(12,l.fontSize*2):24;c.setAttribute("style",`font-weight:bold; font-size:${z}px;`),c.textContent=H,w.appendChild(c)}}),f.appendChild(w),u.appendChild(s)}export{X as render3DFloorStack};
