<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Indoor Map Digitizer</title>


  <script type="module" src="assets/index-D76e248H.js"></script>
  <link rel="stylesheet" href="assets/index-BcsPlOEX.css">
</head>
<body>
  <aside id="backstage-panel" class="backstage-panel">
    <div class="backstage-header">
      <button id="backstage-close-btn" title="Zurück zur Anwendung">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>
      </button>
      <div id="backstage-title" class="backstage-title"></div>
    </div>
    
    <!-- "Datei"-Menü -->
    <div id="backstage-file-content" class="backstage-content">
      <ul>
        <li><button id="newProjectBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14h-3v3h-2v-3H8v-2h3v-3h2v3h3v2zm-3-7V3.5L18.5 9H13z"></path></svg><span>Neues Projekt</span></button></li>
        <li><button onclick="document.getElementById('loadProjectInput').click()"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10z"></path></svg><span>Projekt laden</span></button></li>
        <li><button id="saveProjectBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path></svg><span>Projekt speichern</span></button></li>
        <li><button id="Einleitung"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="currentColor"/><path d="M11 7h2v2h-2zm0 4h2v6h-2z" fill="#fff"/></svg><span>Einleitung</span></button></li>
      </ul>
    </div>

    <!-- "Ausgabe"-Menü -->
    <div id="backstage-output-content" class="backstage-content">
        <ul>
            <li><button id="exportGeoJsonBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"></path></svg><span>GeoJSON exportieren</span></button></li>
            <li><button id="showGeoJsonBtn"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><span>Live Code anzeigen</span></button></li>
        </ul>
        <div class="code-view-wrapper">
          <pre id="live-geojson-output"></pre>
        </div>
    </div>

    <!-- "Übersicht"-Menü -->
    <div id="backstage-overview-content" class="backstage-content">
        <div id="overview-stats-panel">
        </div>
    </div>
  </aside>

  <header class="app-header">
    <div class="logo">IMD Editor</div>
    <nav class="main-menu">
      <button id="file-menu-trigger" class="menu-trigger">Datei</button>
      <button id="output-menu-trigger" class="menu-trigger">Ausgabe</button>
      <button id="overview-menu-trigger" class="menu-trigger">Übersicht</button>
    </nav>
  </header>

  <main class="app-content">
    <aside class="toolbar">
      <section class="toolbar-section">
        <h2 class="toolbar-header">Projekt <span>▼</span></h2>
        <div class="toolbar-content">
          <label for="projectName">Projektname</label>
          <input type="text" id="projectName" placeholder="Projektname eingeben...">
        </div>
      </section>

      <section class="toolbar-section">
        <h2 class="toolbar-header">Bearbeiten <span>▼</span></h2>
        <div class="toolbar-content">
          <div class="button-group">
            <button id="undoBtn" title="Rückgängig (Strg+Z)">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.38 11.23 17.28 8 12.5 8z"></path></svg>
              <span>Rückgängig</span>
            </button>
            <button id="redoBtn" title="Wiederherstellen (Strg+Y)">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.78 0-8.88 3.23-9.87 7.5l-2.37-.78C.39 10.31 5.22 6 11.5 6c2.81 0 5.37 1.09 7.28 2.86L22 6v9h-9l3.4-3.4z"></path></svg>
              <span>Wiederherstellen</span>
            </button>
          </div>
          <button id="deleteBtn" class="danger" disabled>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg>
            <span>Auswahl löschen</span>
          </button>
        </div>
      </section>

      <section class="toolbar-section">
        <h2 class="toolbar-header">Etagen <span>▼</span></h2>
        <div class="toolbar-content">
          <label for="floor-select">Aktuelle Etage</label>
          <select id="floor-select"></select>
          <div class="button-group">
            <button id="addFloorBtn">Neue Etage</button>
            <button onclick="document.getElementById('floorplanInput').click()">Grundriss...</button>
          </div>
          <img id="floor-preview" alt="Grundriss-Vorschau" />
        </div>
      </section>
      
      <section class="toolbar-section">
        <h2 class="toolbar-header active">Werkzeuge <span>▼</span></h2>
        <div class="toolbar-content">
          <div class="tool-buttons">
            <button id="mode-select" class="tool-btn" data-mode="select" title="Elemente auswählen">Auswählen</button>
            <button id="mode-area" class="tool-btn" data-mode="area" title="Rechteck zeichnen">Fläche</button>
            <button id="mode-point" class="tool-btn" data-mode="point" title="Punkt-Element setzen">Element</button>
            <button id="mode-path" class="tool-btn" data-mode="path" title="Offenen Weg zeichnen">Weg</button>
            <button id="mode-line" class="tool-btn" data-mode="line" title="Linie zeichnen">Linie</button>
            <button id="mode-polygon" class="tool-btn" data-mode="polygon" title="Polygon zeichnen">Polygon</button>
            <button id="mode-arc" class="tool-btn" data-mode="arc" title="Bogen zeichnen">Bogen</button>
          </div>
        </div>
      </section>

      <section id="element-options" class="toolbar-section" style="display:none;">
          <h2 class="toolbar-header active">Eigenschaften <span>▼</span></h2>
          <div class="toolbar-content">
            <label for="element-type-select">Element-Typ</label>
            <select id="element-type-select">
              <optgroup label="Flächen">
                <option value="room" data-type="area">Raum</option>
                <option value="office" data-type="area">Büro</option>
                <option value="toiletArea" data-type="area">Toiletten</option>
                <option value="hall" data-type="area">Gang</option>
                <option value="storage" data-type="area">Lager</option>
              </optgroup>
              <optgroup label="Punkt-Elemente">
                <option value="entrance" data-type="point">Eingang</option>
                <option value="extinguisher" data-type="point">Feuerlöscher</option>
              </optgroup>
              <optgroup label="Konnektoren">
                <option value="stairs" data-type="connector">Treppe</option>
                <option value="elevator" data-type="connector">Aufzug</option>
              </optgroup>
            </select>
          </div>
      </section>
      <section id="path-options" class="toolbar-section" style="display:none;">
         <h2 class="toolbar-header active">Weg-Optionen <span>▼</span></h2>
         <div class="toolbar-content">
           <label class="checkbox-label"><input type="checkbox" id="accessiblePath" checked> Barrierefrei</label>
           <button id="finishPathBtn">Weg abschließen</button>
         </div>
      </section>

      <section class="toolbar-section">
        <h2 class="toolbar-header">Ansicht & Layer <span>▼</span></h2>
        <div class="toolbar-content">
            <label class="checkbox-label"><input type="checkbox" id="toggleGridBtn" checked> Raster anzeigen</label>
            <label class="checkbox-label"><input type="checkbox" id="toggleSnapBtn" checked> Am Raster ausrichten</label>
            <div class="grid-control">
                <label for="gridSizeInput">Größe:</label>
                <input type="number" id="gridSizeInput" value="20" min="5" step="5">
            </div>
            <hr>
            <label class="checkbox-label"><input type="checkbox" class="layer-toggle" data-layer="area" checked> Flächen</label>
            <label class="checkbox-label"><input type="checkbox" class="layer-toggle" data-layer="path" checked> Wege/Linien</label>
            <label class="checkbox-label"><input type="checkbox" class="layer-toggle" data-layer="point" checked> Punktelemente</label>
            <hr>
            <button id="show3DViewBtn">3D-Vorschau</button>
        </div>
      </section>
    </aside>

    <div class="workspace">
      <div class="canvas-wrapper">
        <div id="corner-box" class="corner-box" title="Doppelklick zum Zurücksetzen der Ansicht"></div>
        <canvas id="ruler-top" height="30"></canvas>
        <canvas id="ruler-left" width="30"></canvas>
        <div class="canvas-container">
          <canvas id="canvas" width="1200" height="750"></canvas>
        </div>
      </div>
      <div id="floor3DView"></div>
    </div>
  </main>

  <input type="file" id="loadProjectInput" accept=".geojson,.json" class="hidden-input">
  <input type="file" id="floorplanInput" accept="image/*" class="hidden-input">

  <div id="info-modal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-content">
      <button id="info-modal-close-btn" class="modal-close-btn">&times;</button>
      <h2>Willkommen beim IMD Editor!</h2>
      <p>Dies ist ein Werkzeug zur Digitalisierung von Indoor-Karten.</p>
      <h4>Grundlagen der Bedienung:</h4>
      <ul>
        <li><strong>Werkzeuge:</strong> Wählen Sie links ein Werkzeug (z.B. Fläche, Punkt), um Elemente auf der Karte zu erstellen.</li>
        <li><strong>Zoomen:</strong> Benutzen Sie das Mausrad, um in die Karte hinein- und herauszuzoomen.</li>
        <li><strong>Verschieben:</strong> Halten Sie die mittlere Maustaste gedrückt und bewegen Sie die Maus, um die Kartenansicht zu verschieben.</li>
        <li><strong>Speichern:</strong> Vergessen Sie nicht, Ihr Projekt über das "Datei"-Menü zu speichern.</li>
      </ul>
    </div>
  </div>

</body>
</html>